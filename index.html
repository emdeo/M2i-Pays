<!DOCTYPE html>
<html>

<head>
    <title>Arrays (tableaux) JS</title>
    <meta charset="UTF-8" />

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</head>

<body>
    <!-- Nécessaire pour centrer le contenu de la page -->
    <div class="container">

        <h2>Ajoutez les pays de votre choix</h2>

        <!-- Saut de ligne -->
        <br />

        <!-- L'utilisateur entre un pays -->
        <form action="/action_page.php" class="form-horizontal" method="post">
            <div class="form-group row">

                <label for="txtPays" class="col-md-2">Entrez un pays</label>
                <div class="col-md-3">
                    <input type="text" class="form-control" id="txtPays" name="txtPays" placeholder="Un pays">
                </div>

                <!-- On ajoute le pays à la liste quand l'utilisateur appuie sur le bouton -->
                <button id="monBouton" class="btn btn-block btn-outline-primary col-md-2" onclick="Traitement()">
                    Ajouter pays
                </button>

            </div>
        </form>

        <!-- Saut de ligne -->
        <br />

        <!-- Affichage des pays (vide au départ) -->
        <div class="form-group row">
            <label for="txtPays" class="col-md-2">Liste des pays</label>
            <textarea id="txtAreaPays" rows="10" class="col-md-3"></textarea>
        </div>

        <!-- Saut de ligne -->
        <br />

        <!-- Afficher une liste déroulante des pays déjà créés -->
        <div class="form-group row">
            <label for="txtPays" class="col-md-2">Liste des pays</label>
            <select id="selectPays" class="form-group row col-md-3" onchange="UpdateValue(this)">
            </select>
        </div>


        <form action="/action_page.php" class="form-horizontal" method="post">
            <div class="form-group row">

                <label for="txtNewPays" class="col-md-2">Pays sélectionné</label>
                <div class="col-md-3">
                    <input type="text" class="form-control" id="txtNewPays" name="txtNewPays">
                </div>

                <!-- On ajoute le pays à la liste quand l'utilisateur appuie sur le bouton -->
                <button id="monBouton" class="btn btn-block btn-outline-primary col-md-2" onclick="ModifierPays()">
                    Modifier le pays
                </button>

            </div>
        </form>

    </div>

    <script>
        let tableauPays = []

        function Traitement() {
            var newPays = document.getElementById("txtPays").value // récupérer le nouveau pays
            newPays = newPays.toUpperCase() // convertir le nom de pays en majuscules

            // Vérifier si le nouveau pays est déjà dans la liste
            if (tableauPays.indexOf(newPays) == -1) { // équivaut à t.includes(newPays) == false
                tableauPays.push(newPays) // ajouter le nouveau pays au tableau
                AjoutPays(newPays, document.getElementById("selectPays"))
            }
            else {
                alert("Ce pays a déjà été entré")
            }

            document.getElementById("txtAreaPays").value = tableauPays.join("\n") // afficher le tableau dans le TextArea (éléments séparés par un saut de ligne "\n")
            // .innerHTML permet de modifier le contenu stocké entre 2 balises. On peut identifier ces balises grâce à l'id
        }



        function AjoutPays(pays, listeVisuelle) {
            var option1 = document.createElement("option")
            option1.value = pays
            option1.innerHTML = pays
            listeVisuelle.appendChild(option1) // ajouter une balise enfant à l'élément spécifié en paramètre
        }



        function UpdateValue(selection) {
            document.getElementById("txtNewPays").value = selection.value
        }



        function ModifierPays() {
            var oldPays = document.getElementById("selectPays").value
            var newPays = document.getElementById("txtNewPays").value.toUpperCase()

            if (tableauPays.indexOf(newPays) == -1) {
                tableauPays[tableauPays.indexOf(oldPays)] = newPays
                document.getElementById("txtAreaPays").value = tableauPays.join("\n")
                // alert("Remplacement exécuté")
            }
            else {
                // alert("Ce pays est déjà dans la liste, remplacement impossible")
            }
        }
    </script>
</body>

</html>